<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="google-site-verification" content="xBT4GhYoi5qRD5tr338pgPM5OWHHIDR6mNg1a3euekI" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="keyword"  content="">
    <link rel="shortcut icon" href="/img/favicon.ico">

    <title>
        
        js中this指向问题 - CodeBear Personal Blog
        
    </title>

    <!-- Custom CSS -->
    
<link rel="stylesheet" href="/css/aircloud.css">

    
<link rel="stylesheet" href="/css/gitment.css">

    <!--<link rel="stylesheet" href="https://imsun.github.io/gitment/style/default.css">-->
    <link href="//at.alicdn.com/t/font_620856_pl6z7sid89qkt9.css" rel="stylesheet" type="text/css">
    <!-- ga & ba script hoook -->
    <script></script>
<meta name="generator" content="Hexo 5.4.0"></head>

<body>

<div class="site-nav-toggle" id="site-nav-toggle">
    <button>
        <span class="btn-bar"></span>
        <span class="btn-bar"></span>
        <span class="btn-bar"></span>
    </button>
</div>

<div class="index-about">
    <i> 饭可以一日不吃，觉可以一日不睡，书不可以一日不读。 </i>
</div>

<div class="index-container">
    
    <div class="index-left">
        
<div class="nav" id="nav">
    <div class="avatar-name">
        <div class="avatar ">
            <img src="/img/avatar.jpg" />
        </div>
        <div class="name">
            <i>CodeBear</i>
        </div>
    </div>
    <div class="contents" id="nav-content">
        <ul>
            <li >
                <a href="/">
                    <i class="iconfont icon-shouye1"></i>
                    <span>主页</span>
                </a>
            </li>
            <li >
                <a href="/tags">
                    <i class="iconfont icon-biaoqian1"></i>
                    <span>标签</span>
                </a>
            </li>
            <li >
                <a href="/archives">
                    <i class="iconfont icon-guidang2"></i>
                    <span>存档</span>
                </a>
            </li>
            <li >
                <a href="/about/">
                    <i class="iconfont icon-guanyu2"></i>
                    <span>关于</span>
                </a>
            </li>
            
            <li>
                <a id="search">
                    <i class="iconfont icon-sousuo1"></i>
                    <span>搜索</span>
                </a>
            </li>
            
        </ul>
    </div>
    
        <div id="toc" class="toc-article">
    <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80%E3%80%81%E6%99%AE%E9%80%9A%E5%87%BD%E6%95%B0%E8%B0%83%E7%94%A8"><span class="toc-text">一、普通函数调用</span></a></li></ol>
</div>
    
</div>


<div class="search-field" id="search-field">
    <div class="search-container">
        <div class="search-input">
            <span id="esc-search"> <i class="icon-fanhui iconfont"></i></span>
            <input id="search-input"/>
            <span id="begin-search">搜索</span>
        </div>
        <div class="search-result-container" id="search-result-container">

        </div>
    </div>
</div>

        <div class="index-about-mobile">
            <i> 饭可以一日不吃，觉可以一日不睡，书不可以一日不读。 </i>
        </div>
    </div>
    
    <div class="index-middle">
        <!-- Main Content -->
        


<div class="post-container">
    <div class="post-title">
        js中this指向问题
    </div>

    <div class="post-meta">
        <span class="attr">发布于：<span>2021-03-14 21:25:01</span></span>
        
        <span class="attr">标签：/
        
        <a class="tag" href="/tags/#前端基础题" title="前端基础题">前端基础题</a>
        <span>/</span>
        
        
        </span>
        <span class="attr">访问：<span id="busuanzi_value_page_pv"></span>
</span>
</span>
    </div>
    <div class="post-content ">
        <p> 引与<a target="_blank" rel="noopener" href="https://www.cnblogs.com/chengxs/p/8679313.html">这里</a></p>
<p><strong>一、普通函数调用</strong></p>
<p><strong>二、对象函数调用</strong></p>
<p><strong>三、构造函数调用</strong></p>
<p><strong>四、apply和call调用</strong></p>
<p><strong>五、箭头函数调用</strong></p>
<h2 id="一、普通函数调用"><a href="#一、普通函数调用" class="headerlink" title="一、普通函数调用"></a><strong>一、普通函数调用</strong></h2><p>这个情况没特殊意外，就是指向全局对象-window。</p>
<p><strong>1、使用let</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*普通函数调用*/</span></span><br><span class="line"><span class="keyword">let</span> username = <span class="string">&quot;程新松&quot;</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">fn</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="built_in">this</span>.username);   <span class="comment">//undefined</span></span><br><span class="line">&#125;</span><br><span class="line">fn();</span><br></pre></td></tr></table></figure>

<img src="/2021/03/14/js%E4%B8%ADthis%E6%8C%87%E5%90%91%E9%97%AE%E9%A2%98/image-20210314212805398.png" class title="image-20210314212805398">

<p><strong>2、使用var</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> name = <span class="string">&quot;程新松&quot;</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">fn</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="built_in">this</span>.name);</span><br><span class="line">&#125;</span><br><span class="line">fn();</span><br></pre></td></tr></table></figure>

<p>使用node输出的是：undefined</p>
<p>使用谷歌浏览器console输出的是：程新松</p>
<p><strong>3、使用window</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">window</span>.username=<span class="string">&#x27;程新松&#x27;</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">fn</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="built_in">this</span>.username);</span><br><span class="line">&#125;</span><br><span class="line">fn();</span><br></pre></td></tr></table></figure>

<img src="/2021/03/14/js%E4%B8%ADthis%E6%8C%87%E5%90%91%E9%97%AE%E9%A2%98/image-20210314212951656.png" class title="image-20210314212951656">

<p><strong>4、let和var区别：</strong></p>
<p><strong><code>（1）let</code> 允许把变量的作用域限制在块级域中；var</strong> <strong>申明变量要么是全局的，要么是函数级的，而无法是块级的。</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> varClass = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> name=<span class="string">&#x27;程新松&#x27;</span>;</span><br><span class="line">    <span class="keyword">if</span>(<span class="literal">true</span>)&#123;</span><br><span class="line">        <span class="keyword">var</span> name=<span class="string">&#x27;saucxs&#x27;</span>;</span><br><span class="line">        <span class="built_in">console</span>.log(name);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">console</span>.log(name);</span><br><span class="line">&#125;</span><br><span class="line">varClass();</span><br><span class="line"><span class="comment">// saucxs</span></span><br><span class="line"><span class="comment">// saucxs</span></span><br></pre></td></tr></table></figure>

<img src="/2021/03/14/js%E4%B8%ADthis%E6%8C%87%E5%90%91%E9%97%AE%E9%A2%98/image-20210314213048526.png" class title="image-20210314213048526">

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> letClass = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">let</span> name=<span class="string">&#x27;程新松&#x27;</span>;</span><br><span class="line">    <span class="keyword">if</span>(<span class="literal">true</span>)&#123;</span><br><span class="line">        <span class="keyword">let</span> name=<span class="string">&#x27;saucxs&#x27;</span>;</span><br><span class="line">        <span class="built_in">console</span>.log(name);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">console</span>.log(name);</span><br><span class="line">&#125;</span><br><span class="line">letClass();</span><br></pre></td></tr></table></figure>

<img src="/2021/03/14/js%E4%B8%ADthis%E6%8C%87%E5%90%91%E9%97%AE%E9%A2%98/image-20210314213115462.png" class title="image-20210314213115462">

<p><strong>上面的结果说明了let只在｛｝内使用。</strong></p>
<p><strong>（2）先let后var</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> subClass = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">let</span> name=<span class="string">&#x27;程新松&#x27;</span>;</span><br><span class="line">    <span class="keyword">if</span>(<span class="literal">true</span>)&#123;</span><br><span class="line">        <span class="keyword">var</span> name=<span class="string">&#x27;saucxs&#x27;</span>;</span><br><span class="line">        <span class="built_in">console</span>.log(name);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">console</span>.log(name);</span><br><span class="line">&#125;</span><br><span class="line">subClass();</span><br></pre></td></tr></table></figure>

<img src="/2021/03/14/js%E4%B8%ADthis%E6%8C%87%E5%90%91%E9%97%AE%E9%A2%98/image-20210314213152599.png" class title="image-20210314213152599">

<p>var 是函数级作用域，相当于一个作用域中有两个n的变量了</p>
<p>var 作用于整个 subClass ，和let冲突了，let不能重复声明，already been declared=已经被声明</p>
<p><strong>（3）先var后let</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> subClass = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> name=<span class="string">&#x27;程新松&#x27;</span>;</span><br><span class="line">    <span class="keyword">if</span>(<span class="literal">true</span>)&#123;</span><br><span class="line">        <span class="keyword">let</span> name=<span class="string">&#x27;saucxs&#x27;</span>;</span><br><span class="line">        <span class="built_in">console</span>.log(name);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">console</span>.log(name);</span><br><span class="line">&#125;</span><br><span class="line">subClass();</span><br></pre></td></tr></table></figure>

<img src="/2021/03/14/js%E4%B8%ADthis%E6%8C%87%E5%90%91%E9%97%AE%E9%A2%98/image-20210314213240143.png" class title="image-20210314213240143">

<p>先申明var，再申明let，这个没有问题。</p>
<p><strong>二、对象函数调用</strong></p>
<p> 这个相信不难理解，就是<strong>哪个函数调用，this指向哪里</strong>。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*对象函数调用*/</span></span><br><span class="line"><span class="comment">//window.name=&#x27;程新松&#x27;;</span></span><br><span class="line"><span class="comment">//var name=&#x27;程新松&#x27;;</span></span><br><span class="line"><span class="keyword">let</span> name=<span class="string">&#x27;程新松&#x27;</span>;</span><br><span class="line"><span class="keyword">let</span> obj=&#123;</span><br><span class="line">    id:<span class="number">201102304</span>,</span><br><span class="line">    fn:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="built_in">this</span>.name);  <span class="comment">//undefined</span></span><br><span class="line">        <span class="built_in">console</span>.log(<span class="built_in">this</span>.id);   <span class="comment">//201102304</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">obj.fn();</span><br></pre></td></tr></table></figure>

<img src="/2021/03/14/js%E4%B8%ADthis%E6%8C%87%E5%90%91%E9%97%AE%E9%A2%98/image-20210314213318807.png" class title="image-20210314213318807">

<p>很明显，第一次就是输出 <code>obj.name</code> ，但是没有这个name属性，输出的结果undefined。而第二次输出<code>obj.id，有这个id属性，</code>输出 201102304，<strong>因为 <code>this</code> 指向 <code>obj</code> 。</strong></p>
<p> <strong>有一种情况需要注意：</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*需要注意的情况*/</span></span><br><span class="line"><span class="keyword">let</span> obj1=&#123;</span><br><span class="line">    a:<span class="number">111</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> obj2=&#123;</span><br><span class="line">    a:<span class="number">222</span>,</span><br><span class="line">    fn:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="built_in">this</span>.a);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">obj1.fn=obj2.fn;</span><br><span class="line">obj1.fn();  <span class="comment">//111</span></span><br></pre></td></tr></table></figure>

<img src="/2021/03/14/js%E4%B8%ADthis%E6%8C%87%E5%90%91%E9%97%AE%E9%A2%98/image-20210314213352343.png" class title="image-20210314213352343">

<p>这个也不难理解，虽然 <code>obj1.fn</code> 是从 <code>obj2.fn</code> 赋值而来，但是调用函数的是 <code>obj1</code> ，所以 <strong><code>this</code> 指向 <code>obj1</code></strong> 。</p>
<p><strong>三、构造函数调用</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*构造函数调用*/</span></span><br><span class="line"><span class="keyword">let</span> structureClass=<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">this</span>.name=<span class="string">&#x27;程新松&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> subClass1=<span class="keyword">new</span> structureClass();</span><br><span class="line"><span class="built_in">console</span>.log(subClass1.name);</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> subClass=<span class="keyword">new</span> structureClass();</span><br><span class="line">subClass.name=<span class="string">&#x27;成才&#x27;</span>;</span><br><span class="line"><span class="built_in">console</span>.log(subClass.name);</span><br></pre></td></tr></table></figure>

<img src="/2021/03/14/js%E4%B8%ADthis%E6%8C%87%E5%90%91%E9%97%AE%E9%A2%98/image-20210314213431971.png" class title="image-20210314213431971">

<p>但是有一个坑，虽然一般不会出现，但是有必要提一下。</p>
<p><strong>在构造函数里面返回一个对象，会直接返回这个对象，而不是执行构造函数后创建的对象</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> structureClass=<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">this</span>.name=<span class="string">&#x27;程新松&#x27;</span>;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        username:<span class="string">&#x27;saucxs&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> subClass1=<span class="keyword">new</span> structureClass();</span><br><span class="line"><span class="built_in">console</span>.log(subClass1);</span><br><span class="line"><span class="built_in">console</span>.log(subClass1.name);</span><br></pre></td></tr></table></figure>

<img src="/2021/03/14/js%E4%B8%ADthis%E6%8C%87%E5%90%91%E9%97%AE%E9%A2%98/image-20210314213502240.png" class title="image-20210314213502240">

<p><strong>四、apply和call调用</strong></p>
<p> <strong>1、apply和call简单来说就是会改变传入函数的this。</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*apply和call调用*/</span></span><br><span class="line"><span class="keyword">let</span> obj1=&#123;</span><br><span class="line">    name:<span class="string">&#x27;程新松&#x27;</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">let</span> obj2=&#123;</span><br><span class="line">    name:<span class="string">&#x27;saucxs&#x27;</span>,</span><br><span class="line">    fn:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="built_in">this</span>.name);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">obj2.fn.call(obj1);</span><br></pre></td></tr></table></figure>

<img src="/2021/03/14/js%E4%B8%ADthis%E6%8C%87%E5%90%91%E9%97%AE%E9%A2%98/image-20210314213534128.png" class title="image-20210314213534128">

<p><strong>此时虽然是 <code>obj2</code> 调用方法，但是使用 了 <code>call</code> ，动态的把 <code>this</code> 指向到 <code>obj1</code> 。相当于这个 <code>obj2.fn</code> 这个执行环境是 <code>obj1</code> 。</strong></p>
<p><strong><code>call</code> 和 <code>apply</code> 两个主要用途：</strong></p>
<p>1.改变 <code>this</code> 的指向（把 <code>this</code> 从 <code>obj2</code> 指向到 <code>obj1</code> ）</p>
<p>2.方法借用（ <code>obj1</code> 没有 <code>fn</code> ，只是借用 <code>obj2</code> 方法）</p>
<p><strong>2、call与apply区别</strong></p>
<p> <code>call</code> 和 <code>apply</code> 的作用，完全一样，唯一的区别就是在参数上面。</p>
<p><strong><code>call</code> 接收的参数不固定，第一个参数是函数体内 <code>this</code> 的指向，第二个参数以下是依次传入的参数。</strong></p>
<p><strong>apply接收两个参数，第一个参数也是函数体内 <code>this</code> 的指向。第二个参数是一个集合对象（数组或者类数组）</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*apply和call区别*/</span></span><br><span class="line"><span class="keyword">let</span> fn=<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c</span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(a,b,c);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> arrArray=[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>];</span><br><span class="line">fn.call(<span class="built_in">window</span>,arrArray);</span><br><span class="line">fn.apply(<span class="built_in">window</span>,arrArray);</span><br></pre></td></tr></table></figure>

<img src="/2021/03/14/js%E4%B8%ADthis%E6%8C%87%E5%90%91%E9%97%AE%E9%A2%98/image-20210314213614310.png" class title="image-20210314213614310">

<p> <strong>五、箭头函数调用</strong></p>
<p> 首先不得不说，ES6 提供了箭头函数，增加了我们的开发效率，<strong>但是在箭头函数里面，没有 <code>this</code></strong> ，<strong>箭头函数里面的 <code>this</code> 是继承外面的环境</strong>。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*箭头函数调用*/</span></span><br><span class="line"><span class="keyword">let</span> obj=&#123;</span><br><span class="line">    name:<span class="string">&#x27;程新松&#x27;</span>,</span><br><span class="line">    fn:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="built_in">setTimeout</span>(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="built_in">console</span>.log(<span class="built_in">this</span>.name)&#125;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">obj.fn();</span><br></pre></td></tr></table></figure>

<img src="/2021/03/14/js%E4%B8%ADthis%E6%8C%87%E5%90%91%E9%97%AE%E9%A2%98/image-20210314213641400.png" class title="image-20210314213641400">

<p>不难发现，虽然 <strong>fn()</strong> 里面的 <strong>this</strong> 是指向 <strong>obj</strong> ，但是，传给 <strong>setTimeout</strong> 的是普通函数， <strong>this</strong> 指向是 <strong>window</strong> ， <strong>window</strong> 下面没有 <strong>name</strong> ，所以这里输出 <strong>underfind</strong> 。</p>
<p> <strong>换成箭头函数</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//换成箭头函数</span></span><br><span class="line"><span class="keyword">let</span> obj=&#123;</span><br><span class="line">    name:<span class="string">&quot;程新松&quot;</span>,</span><br><span class="line">    fn:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="built_in">setTimeout</span>(<span class="function">()=&gt;</span>&#123;<span class="built_in">console</span>.log(<span class="built_in">this</span>.name)&#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">obj.fn();</span><br></pre></td></tr></table></figure>

<img src="/2021/03/14/js%E4%B8%ADthis%E6%8C%87%E5%90%91%E9%97%AE%E9%A2%98/image-20210314213710596.png" class title="image-20210314213710596">

<p>这次输出 <strong>程新松</strong> 是因为，传给 <strong>setTimeout</strong> 的是箭头函数，然后箭头函数里面没有 <strong>this</strong> ，所以要向上层作用域查找，在这个例子上， <strong>setTimeout</strong> 的上层作用域是 <strong>fn</strong> 。而 <strong>fn</strong> 里面的 <strong>this</strong> 指向 <strong>obj</strong> ，所以 <strong>setTimeout</strong> 里面的箭头函数的 <strong>this</strong> ，指向 <strong>obj</strong> 。所以输出 <strong>程新松</strong>。</p>

        
        <br />
        <div id="comment-container">
        </div>
        <div id="disqus_thread"></div>

        <div id="lv-container">
        </div>

    </div>
</div>

    </div>
</div>


<footer class="footer">
    <ul class="list-inline text-center">
        
        
        <li>
            <a target="_blank" href="https://www.zhihu.com/people/ai-er-lan-xue-da">
                            <span class="fa-stack fa-lg">
                                 <i class="iconfont icon-zhihu"></i>
                            </span>
            </a>
        </li>
        

        
        <li>
            <a target="_blank" href="http://weibo.com/3286578617">
                            <span class="fa-stack fa-lg">
                                  <i class="iconfont icon-weibo"></i>
                            </span>
            </a>
        </li>
        

        

        
        <li>
            <a target="_blank"  href="https://github.com/AirCloud">
                            <span class="fa-stack fa-lg">
                                <i class="iconfont icon-github"></i>
                            </span>
            </a>
        </li>
        

        

    </ul>
    
    <p>
        <span>/</span>
        
        <span><a target="_blank" rel="noopener" href="https://www.10000h.top">10000H</a></span>
        <span>/</span>
        
        <span><a target="_blank" rel="noopener" href="https://niexiaotao.com">Xiaotao&#39;s Page</a></span>
        <span>/</span>
        
        <span><a href="#">It helps SEO</a></span>
        <span>/</span>
        
    </p>
    
    <p>
        <span id="busuanzi_container_site_pv">
            <span id="busuanzi_value_site_pv"></span>PV
        </span>
        <span id="busuanzi_container_site_uv">
            <span id="busuanzi_value_site_uv"></span>UV
        </span>
        Created By <a target="_blank" rel="noopener" href="https://hexo.io/">Hexo</a>  Theme <a target="_blank" rel="noopener" href="https://github.com/aircloud/hexo-theme-aircloud">AirCloud</a></p>
</footer>




</body>

<script>
    // We expose some of the variables needed by the front end
    window.hexo_search_path = "search.json"
    window.hexo_root = "/"
    window.isPost = true
</script>
<script src="https://cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script>

<script src="/js/index.js"></script>

<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>




</html>
